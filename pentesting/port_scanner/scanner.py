#!/usr/bin/python

import nmap

def Scan_all_ports(ip):

	scanner = nmap.PortScanner()
	scanner.scan(ip, '1-65535')
	scanning = scanner[ip]['tcp'].keys()
	print ""
	print "The ports " + str(scanning) + " are opened "
	print ""

def Scan_some_ports(ip, ports):

	scanner = nmap.PortScanner()
	scanner.scan(ip, str(ports))
	state = scanner[ip]['tcp'].keys()
	print ""
	print "The ports " + str(state) + " are opened "
	print ""


def Discover_hostname(ip):

	scanner = nmap.PortScanner()
	scanner.scan(ip, '1-10')
	host = scanner[ip].hostname()
	print ""
	print "The hostname for the target is: " + host
	print ""

def main():

	opc = 0
	while True:

		print ""
		print "-----------------------------"
		print "[1] SCAN ALL PORTS           |"
		print "[2] SCAN PORTS RANGE         |"
		print "[3] DISCOVER HOSTNAME        |"
		print "[4] EXIT PROGRAM             |"
		print "-----------------------------"

		opc = input("Select an option from the menu: ")

		if opc == 1:
			ip_address = raw_input("Enter the target ip address: ")
			Scan_all_ports(ip_address)

		elif opc == 2:
			ipaddr = raw_input("Enter the target ip address: ")
			ports = input("Enter the ports range to scan for(1-65535): ")
			Scan_some_ports(ipaddr, ports)

		elif opc == 3:
			ip = raw_input("Enter the target ip address: ")
			Discover_hostname(ip)

		elif opc == 4:
			print "Exit Program....."
			exit(0)

		else:
			print "The option " + str(opc) + " does not exist"
			print ""

if __name__ == '__main__':
	main()