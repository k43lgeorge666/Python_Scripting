#!/usr/bin/python

import zipfile
import optparse


def Password_Cracker(zip, dic):
	file = open(dic, "r")
	read = file.readlines()

	for line in read:
		word = line.split("\n")

		try:
			zip_file = zipfile.ZipFile(zip)
			zip_file.extractall(pwd=str(word[0]))
			password = (str(word[0]))
			print ""
			print "[+] Password Cracked! ", password
			print ""
			exit(0)
		except:
			print "[-] Trying cracking with : ", (str(word[0]))

	print ""
	print "[+] The password for the zip file is: ", password
	print ""

def main():
	parser = optparse.OptionParser("./Program.py -Z <Zip_file_name> -D <Dictionary_Name>")
	parser.add_option("-Z", dest="zipfile", type="string", help="Specify the zip file")
	parser.add_option("-D", dest="zip_dic", type="string", help="Specify the dictionary file")

	(options,args) = parser.parse_args()
	zip_file = options.zipfile
	dictionary = options.zip_dic

	if(zip_file == None) | (dictionary == None):
		parser.print_help()
		exit(0)
	Password_Cracker(zip_file, dictionary)

if __name__ == '__main__':
	main()